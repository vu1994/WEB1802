<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:f="http://xmlns.jcp.org/jsf/core"    
      xmlns:b="http://bootsfaces.net/ui"
      >
    <h:head>
        <title>CẤP PHÁT THIẾT BỊ</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
        <h:outputStylesheet name="css/style.css" />
        <h:outputStylesheet name="css/stylesheet.css"/>
        <h:outputStylesheet name="css/font-awesome.min.css"/>
        <h:outputStylesheet name="css/main.css" library="resources"/>
        <h:outputStylesheet name="css/bootstrap/bootstrap.min.css" library="resources"/>
        <h:outputStylesheet name="css/ionicons.min.css" library="resources"/>
        <h:outputStylesheet name="css/_all-skins.min.css" library="resources"/>
        <h:outputStylesheet name="css/bootstrap/bootstrap3-wysihtml5.min.css" library="resources"/>
        <h:outputStylesheet name="css/bootstrap/bootstrap-datepicker.min.css" library="resources"/>
        <h:outputStylesheet name="css/AdminLTE.min.css" library="resources"/>
        <h:outputStylesheet name="css/main.css" library="resources"/>
        <h:outputStylesheet name="css/animation.css" library="resources"/>
        <h:outputStylesheet name="css/responsive.css" library="resources"/>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic"/>

        <h:outputScript name="js/bootstrap/jquery.min.js" library="resources"/>
        <h:outputScript name="js/bootstrap/bootstrap.min.js" library="resources"/>
        <h:outputScript name="js/adminlte.min.js" library="resources"/>
        <h:outputScript name="js/fastclick.js" library="resources"/>
        <h:outputScript name="js/demo.js" library="resources"/>
        <h:outputScript name="js/dashboard.js" library="resources"/>
        <h:outputScript name="js/jquery.slimscroll.min.js" library="resources"/>
        <h:outputScript name="js/jquery.sparkline.min.js" library="resources"/>
        <h:outputScript name="js/raphael.min.js" library="resources"/>
        <h:outputScript name="js/bootstrap/bootstrap-datepicker.min.js" library="resources"/>
        <h:outputScript name="js/bootstrap/bootstrap3-wysihtml5.all.min.js" library="resources"/>
        <h:outputScript name="js/window.js" library="resources"/>
        <h:outputScript name="js/classcommon.js" library="resources"/>


    </h:head>
    <h:body>
        <f:event listener="#{UserController.callWhenLoadPage()}" type="preRenderView" />
        <style>
            .modal.in .modal-dialog{
                margin-top: 150px;
            }
            .modal-header{
                padding: 5px 15px;
                border-bottom: 1px solid #e5e5e5;
                height: 50px;
                font-family: initial;
                font-weight: bold;
            }
            .close{
                padding: 10px 10px 10px 10px !important;
                color: #993333
            }
            .label{
                font-family: Times New Roman Georgia !important;
            }
            .register a:hover{
                color: #00FF00 !important;
                background-color: transparent !important;
                text-decoration: none;
            }
            .register .single_login, .register .single_register{
                cursor: pointer;
            }
            .btn-edit {
                background-color: initial !important;
                color: #0891b3 !important;
                border: none !important;
            }

            .btn-delete {
                background-color: initial !important;
                color: red !important;
                border: none !important;
            }
            .inputMask{
                text-align: left !important;
            }

        </style>
        <!-- script căn chỉnh màn hình-->

        <h:form>        
            <div class="col-md-12 col-sm-12 col-xs-12" style="text-align:right;top:10px">
                <h:outputText class="text-red" rendered="#{UserController.mapLogin.logined}" value="Xin chào #{UserController.mapLogin.nvTen}!"/>
            </div>
            <section id="home" class="home">
                <div class="home-overlay-fluid">
                    <div class="container">
                        <div class="row">
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <b:growl  showDetail="true" severity="info"  showSummary="false" delay="3000"/>
                                </div>
                            </div>
                            <div class="main_slider_area">
                                <div class="slider">
                                    <div class="container">
                                        <div class="row">
                                            <div class="main_service text-center">
                                                <h:panelGroup rendered="#{!UserController.mapLogin.logined or(UserController.mapLogin.logined and UserController.mapLogin.userRole==1)}">
                                                    <div class="col-md-3 col-sm-6 col-xs-6 icon1">
                                                        <div class="single_service wow fadeIn " data-wow-duration=".6s">
                                                            <div class="single_service_icon icon_one hvr-float-shadow">
                                                                <b:link rendered="#{UserController.mapLogin.logined and UserController.mapLogin.userRole==1}" href="faces/pages/danh-muc/QuanLyThietBi.xhtml"> <i class="fa fa-home"></i></b:link>
                                                                <b:link rendered="#{UserController.mapLogin.logined and UserController.mapLogin.userRole==0}" onclick="$('.formRole').modal()"><i class="fa fa-home"></i></b:link>
                                                                <b:link rendered="#{!UserController.mapLogin.logined}" onclick="$('.formPreLogin').modal()"><i class="fa fa-home"></i></b:link>
                                                            </div>
                                                            <div class="single_service_deatels">
                                                                <h4>QUẢN LÝ KHO</h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </h:panelGroup>
                                                <h:panelGroup rendered="#{!UserController.mapLogin.logined or(UserController.mapLogin.logined and UserController.mapLogin.userRole==1)}">
                                                    <div class="col-md-3 col-sm-6 col-xs-6 icon1">
                                                        <div class="single_service wow fadeIn" data-wow-duration="1.2s">
                                                            <div class="single_service_icon icon_two hvr-float-shadow">
                                                                <b:link rendered="#{UserController.mapLogin.logined and UserController.mapLogin.userRole==1}" href="faces/pages/bao-cao/ThongKeTonKho.xhtml"><i class="fa fa-bar-chart fa-lg"></i></b:link>
                                                                <b:link rendered="#{UserController.mapLogin.logined and UserController.mapLogin.userRole==0}" onclick="$('.formRole').modal()"><i class="fa fa-bar-chart fa-lg"></i></b:link>
                                                                <b:link rendered="#{!UserController.mapLogin.logined}" onclick="$('.formPreLogin').modal()"><i class="fa fa-bar-chart fa-lg"></i></b:link>
                                                            </div>
                                                            <div class="single_service_deatels">
                                                                <h4>THỐNG KÊ</h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </h:panelGroup>
                                                <h:panelGroup rendered="#{!UserController.mapLogin.logined or(UserController.mapLogin.logined and UserController.mapLogin.userRole==1)}">
                                                    <div class="col-md-3 col-sm-6 col-xs-6 icon1">
                                                        <div class="single_service wow fadeIn" data-wow-duration="1.7s">
                                                            <div class="single_service_icon icon_three hvr-float-shadow">
                                                                <b:link rendered="#{UserController.mapLogin.logined and UserController.mapLogin.userRole==1}" href="faces/pages/capphat-suachua/quanlycapphat.xhtml"><i class="fa fa-desktop"></i></b:link>
                                                                <b:link rendered="#{UserController.mapLogin.logined and UserController.mapLogin.userRole==0}" onclick="$('.formRole').modal()"><i class="fa fa-desktop"></i></b:link>
                                                                <b:link rendered="#{!UserController.mapLogin.logined}" onclick="$('.formPreLogin').modal()"><i class="fa fa-desktop"></i></b:link>
                                                            </div>
                                                            <div class="single_service_deatels">
                                                                <h4>CẤP PHÁT</h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </h:panelGroup>
                                                <h:panelGroup rendered="#{!UserController.mapLogin.logined or(UserController.mapLogin.logined and UserController.mapLogin.userRole==1)}">
                                                    <div class="col-md-3 col-sm-6 col-xs-6 icon1 ">
                                                        <div class="single_service wow fadeIn" data-wow-duration="2s">
                                                            <div class="single_service_icon icon_four hvr-float-shadow">
                                                                <b:link rendered="#{UserController.mapLogin.logined and UserController.mapLogin.userRole==1}" href="faces/pages/phongban/quanLyPhongBan.xhtml"><i class="fa fa-users"></i></b:link>
                                                                <b:link rendered="#{UserController.mapLogin.logined and UserController.mapLogin.userRole==0}" onclick="$('.formRole').modal()"><i class="fa fa-users"></i></b:link>
                                                                <b:link rendered="#{!UserController.mapLogin.logined}" onclick="$('.formPreLogin').modal()"><i class="fa fa-users"></i></b:link>
                                                            </div>
                                                            <div class="single_service_deatels">
                                                                <h4>PHÒNG BAN</h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </h:panelGroup>
                                                <h:panelGroup rendered="#{UserController.mapLogin.logined and UserController.mapLogin.userRole==0}">
                                                    <div class="col-md-3 col-md-offset-3 col-sm-6 col-xs-6 icon1 ">
                                                        <div class="single_service wow fadeIn" data-wow-duration="2s">
                                                            <div class="single_service_icon icon_four hvr-float-shadow">
                                                                <b:link onclick="#{QuanLyYeuCauSCController.actionListDmYeuCauNvId()}" oncomplete="$('.yeuCauSuaChuaPopUp').modal()"><i class="fa fa-wrench"></i>
                                                                    <f:ajax render="yeuCauSCForm" execute="@this"/>
                                                                </b:link>
                                                                <!--                                                                <b:commandButton  actionListener="" 
                                                                                                                                               onclick="$('.yeuCauSuaChuaPopUp').modal()" update="@form">
                                                                                                                                    <f:ajax render="yeuCauSCForm" execute="@this"/>
                                                                                                                                    <i class="fa fa-wrench"></i>
                                                                                                                                </b:commandButton>-->
                                                            </div>
                                                            <div class="single_service_deatels">
                                                                <h4>QUẢN LÝ YÊU CẦU</h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3 col-sm-6 col-xs-6 icon1 ">
                                                        <div class="single_service wow fadeIn" data-wow-duration="2s">
                                                            <div class="single_service_icon icon_one hvr-float-shadow">
                                                                <b:link href="faces/pages/phongban/quanLyPhongBan.xhtml"><i class="fa fa-user"></i></b:link>
                                                            </div>
                                                            <div class="single_service_deatels">
                                                                <h4>THÔNG TIN CÁ NHÂN</h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </h:panelGroup>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="register" class="register" style="position: fixed; bottom:0px;">
                    <div class="container-fullwidth">
                        <div class="row text-center">
                            <div class="col-sm-6 col-xs-6 no-padding">
                                <div class="single_register single_login " onclick="$('.dangNhapPopUp').modal()">
                                    <b:link rendered="#{!UserController.mapLogin.logined}">
                                        <i class="fa fa-sign-in"/> ĐĂNG NHẬP
                                    </b:link>
                                    <b:commandLink rendered="#{UserController.mapLogin.logined}"
                                                   >
                                        <i class="fa fa-sign-out"/> ĐĂNG XUẤT
                                        <f:ajax listener="#{UserController.logout()}" render="@all"/>
                                    </b:commandLink>
                                </div>
                            </div>
                            <div class="col-sm-6 col-xs-6 no-padding">
                                <div class="single_register" onclick="$('.formPreLogin').modal()"  style="display:#{!UserController.mapLogin.logined?'block':'none'}">
                                    <b:link >
                                        <i class="fa fa-wrench fa-spin"/> YÊU CẦU SỬA CHỮA 
                                    </b:link>
                                </div>
                                <div class="single_register" onclick="$('.formYCauSChuaPopUp').modal()" style="display:#{UserController.mapLogin.logined?'block':'none'}">
                                    <b:link>
                                        <i class="fa fa-wrench fa-spin"/> YÊU CẦU SỬA CHỮA 
                                    </b:link>
                                </div>
                            </div>
                        </div>
                    </div>    
                </div>
            </section><!-- End of Banner Section -->

        </h:form>



        <!-- modal Login-->
        <b:modal id="amodal2" title="ĐĂNG NHẬP" styleClass="dangNhapPopUp"
                 closable="true"  close-on-escape="true" backdrop="true">
            <b:form id="loginForm">
                <div class="row">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <b:messages showDetail="true" errorClass="error_msg" severity="error"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <b:inputText id="usernameDiv"
                                     value="#{UserController.screenname}"
                                     a:placeholder="Tài khoản"
                                     required="true"
                                     requiredMessage="Vui lòng nhập tên tài khoản"
                                     label="TÀI KHOẢN"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 col-sm-12 col-xs-12">
                        <b:inputSecret id="passwordDiv"
                                       value="#{UserController.password}"
                                       a:placeholder="Mật khẩu"
                                       required="true"
                                       requiredMessage="Vui lòng nhập mật khẩu"
                                       label="MẬT KHẨU"  />
                    </div>
                </div>
                <div class="row margin-t-10">
                    <div class="col-md-12 col-sm-12 col-xs-12 text-center">
                        <b:commandButton process="@form"
                                         update="@form"
                                         value="ĐĂNG NHẬP"
                                         action="#{UserController.login()}"
                                         class="btn-danger"/>
                    </div>
                </div>
            </b:form>
        </b:modal>

        <!-- modal Thông báo chưa đăng nhập-->

        <b:modal id="modalPreLogin" title="THÔNG BÁO TỪ HỆ THỐNG" styleClass="formPreLogin"
                 closable="true"  close-on-escape="true" backdrop="true">
            <b:form id="preLogin" horizontal="false">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
                        <h:outputText value="Bạn "/>
                        <h:outputLabel value="CHƯA ĐĂNG NHẬP" class="text-danger"/>
                        <h:outputText value=" vào hệ thống!"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
                        <p>Bạn có muốn Đăng nhập?</p>
                    </div>
                </div>

                <div class="row margin-t-15">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
                        <b:button class="btn-huybo" dismiss="modal" 
                                  icon-awesome="fa-key"  
                                  onclick="$('.dangNhapPopUp').modal()" 
                                  value="Đăng nhập"
                                  styleClass="btn btn-danger"
                                  style="margin-right: 10px">
                        </b:button>
                        <b:button class="btn-huybo" dismiss="modal" 
                                  icon-awesome="fa-close" value="Hủy bỏ">
                        </b:button>
                    </div>
                </div>
            </b:form>
        </b:modal>

        <!--Modal yêu cầu sửa chửa-->
        <b:modal id="modalCapPhat" title="YÊU CẦU SỬA CHỮA" styleClass="formYCauSChuaPopUp"
                 closable="true"  close-on-escape="true" backdrop="true">
            <b:form id="yeuCauSuaChuaForm" horizontal="false">
                <h:panelGroup id="thietbi">
                    <div class="row">
                        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                            <h:outputLabel value="Nhóm thiết bị"/>
                            <b:selectOneMenu value="#{QuanLyThietBiController.selectedNhomTB}">
                                <f:selectItem itemLabel="-- Tất cả --" itemValue=""/>
                                <f:selectItems value="#{DanhMucThietBiController.listDmThietBi}" var="item" itemLabel="#{item.danhmuc_thietbi_ten}" itemValue="#{item.danhmuc_thietbi_id}" />          
                                <f:facet name="prepend">
                                    <b:iconAwesome name="fa-align-justify" />
                                </f:facet>
                                <f:ajax listener="#{QuanLyThietBiController.actionChangeNhomTB()}" render="selectThietBiSuaChua thietbi"/>
                            </b:selectOneMenu>
                        </div>

                        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4" style="padding-top: 30px;text-align: center;display: #{empty(QuanLyThietBiController.listThietBi)?'':'none'}">
                            <h:outputText value="Không có thiết bị cần sửa chữa" styleClass="text-red"/>
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4" id="thietbi" style="display: #{!empty(QuanLyThietBiController.listThietBi)?'':'none'}">
                            <h:outputLabel value="Thiết bị" />
                            <b:selectOneMenu id="selectThietBiSuaChua"
                                             required="true"
                                             requiredMessage="Vui lòng chọn thiết bị"
                                             value="#{QuanLyYeuCauSCController.objYeuCauSC.yeucauTbID}">
                                <f:selectItem itemLabel="-- Chọn thiết bị --" itemValue=""/>
                                <f:selectItems value="#{QuanLyThietBiController.listThietBi}" var="item"
                                               itemLabel="#{item.thietbi_ten}" itemValue="#{item.thietbi_id}"/>
                                <f:facet name="prepend">
                                    <b:iconAwesome name="fa-desktop" />
                                </f:facet>
                            </b:selectOneMenu>
                            <b:message for="selectThietBiSuaChua"/>
                        </div>

                        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4" style="display: #{!empty(QuanLyThietBiController.listThietBi)?'':'none'}">
                            <h:outputLabel value="Ngày yêu cầu"/>
                            <b:dateTimePicker  id="dateNgayCap"
                                               value="#{QuanLyYeuCauSCController.objYeuCauSC.yeucauNgayYeuCau}"
                                               iconPosition='left'
                                               allow-input-toggle='true'
                                               rendered="true"
                                               requiredMessage="Vui lòng chọn ngày cấp phát"
                                               show-time="false"
                                               show-date="true"
                                               format="DD/MM/YYYY"
                                               minDate="#{QuanLyYeuCauSCController.objYeuCauSC.yeucauNgayYeuCau}"
                                               >
                            </b:dateTimePicker >
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="display: #{!empty(QuanLyThietBiController.listThietBi)?'':'none'}">
                            <b:inputTextarea value="#{QuanLyYeuCauSCController.objYeuCauSC.yeucauTinhTrangHong}" label="Tình trạng" placeholder="Nhập các vấn đề hư hỏng của thiết bị hoặc tình trạng của thiết bị hiện tại..." />
                        </div>
                    </div>

                    <div class="row margin-t-15">
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
                            <b:commandButton action="#{QuanLyYeuCauSCController.actionAddYeuCau()}"
                                             styleClass="btn btn-danger margin-r-5" ajax="true"
                                             process="@form" update="@form" 
                                             rendered="#{!empty(QuanLyThietBiController.listThietBi)}">
                                <i class="fa fa-save"></i> Lưu
                            </b:commandButton>
                            <b:button class="btn-huybo" dismiss="modal" icon-awesome="fa-close" value="Hủy bỏ">
                            </b:button>
                        </div>
                    </div>
                </h:panelGroup>
            </b:form>
        </b:modal>

        <!--Modal Quản lý yêu cầu-->
        <b:modal id="amodal1" title="QUẢN LÝ YÊU CẦU SỬA CHỮA" 
                 styleClass="yeuCauSuaChuaPopUp"
                 closable="true"  
                 close-on-escape="true" 
                 backdrop="true"
                 rendered="#{UserController.mapLogin.logined and UserController.mapLogin.userRole==0}"
                 >
            <b:form id="yeuCauSCForm" horizontal="false">
                <div class="row" style="margin-bottom: 10px">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                        <h:outputLabel value="Người yêu cầu :" styleClass="text-primary"/>
                        <h:outputText value=" #{UserController.mapLogin.nvTen}" styleClass="text-danger" />
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                        <b:dataTable id='myTablePB' value="#{QuanLyYeuCauSCController.listYeuCauSCByNv}"
                                     var="item"
                                     searching="true"
                                     excel="true"
                                     pdf="true"
                                     responsive="true"
                                     style="width:100% !important;">

                            <b:dataTableColumn label="STT" value="#{item.rowIndex}" headerStyleClass="text-center"/>
                            <b:dataTableColumn label="Thiết bị" value="#{item.thietbi_ten}" headerStyleClass="text-center"/>    
                            <b:dataTableColumn label="Ngày yêu cầu"  headerStyleClass="text-center">
                                <h:outputText value="#{item.yeucau_ngayyeucau}" >
                                    <f:convertDateTime pattern="dd/MM/yyyy" timeZone="GMT+7"/>
                                </h:outputText>
                            </b:dataTableColumn>
                            <b:dataTableColumn value="#{item.yeucau_tinhtranghong}" label="Tình trạng hư hỏng" headerStyleClass="text-center"/>
                            <b:dataTableColumn value="#{item.yeucau_tinhtrang_ten}"  label="Trạng thái xử lý" headerStyleClass="text-center"/>
                            <b:dataTableColumn label="Hủy" style="width:5%" orderable="false" class="text-center">
                                <b:commandButton styleClass="btn-delete" 
                                                 actionListener="#{QuanLyYeuCauSCController.huyYeuCau(item)}" 
                                                 update="@form" 
                                                 oncomplete="$('.themNhanVienPopUp').modal()"
                                                 rendered="#{item.yeucau_tinhtrangsc &lt;0 or item.yeucau_tinhtrangsc==0}">
                                    <i class="fa fa-close"></i>
                                    <f:ajax render="yeuCauSCForm" execute="@this" />
                                </b:commandButton>
                            </b:dataTableColumn>
                        </b:dataTable>
                    </div>
                </div>
            </b:form>
        </b:modal>
    </h:body>
    <script>
        $("#home").css("height", $(window).height());
        $(".home-overlay-fluid").css("height", $(window).height());
        $(".home-overlay-fluid").css("padding-top", ($(window).height() / 2.5));

    </script>
</html>

